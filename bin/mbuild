#!/usr/bin/env node
const program = require('commander');
const pkg = require('../package.json');
const version = pkg.version;

before(program, 'unknownOption', function() {
  program.outputHelp();
});
before(program, 'optionMissingArgument', function() {
  program.outputHelp();
});

/**
* 钩子
*/
function before(obj, method, cb) {
  const old = obj[method];
  obj[method] = function() {
    cb.call(this);
    old.apply(this, arguments);
  }
}

program
  .version(version, '-V, --version')
  .alias('m')
  .usage('<options> [type]')
  .option('-t, --task <type>', 'choose a type of build task(server|online)[server]')
  .option('    --lib [name]', 'you need variable add Window Object')
  .parse(process.argv);

if (!process.argv.slice(2).length) {
  program.outputHelp();
}

require('../index.js')(program);
